//******************************************************************************
//  @file RtosMutex.cpp
//  @author Nicolai Shlapunov
//
//  @details DevCore: FreeRTOS Mutex Wrapper Class, implementation
//
//  @copyright Copyright (c) 2018, Devtronic & Nicolai Shlapunov
//             All rights reserved.
//
//  @section SUPPORT
//
//   Devtronic invests time and resources providing this open source code,
//   please support Devtronic and open-source hardware/software by
//   donations and/or purchasing products from Devtronic.
//
//******************************************************************************

#ifndef RtosMutex_h
#define RtosMutex_h

// *****************************************************************************
// ***   Includes   ************************************************************
// *****************************************************************************
#include "DevCfg.h"
#include "Rtos.h"
#include "semphr.h"

// *****************************************************************************
// ***   RtosMutex   ***********************************************************
// *****************************************************************************
class RtosMutex
{
  public:
    // *************************************************************************
    // ***   Constructor   *****************************************************
    // *************************************************************************
    RtosMutex();

    // *************************************************************************
    // ***   Destructor   ******************************************************
    // *************************************************************************
    ~RtosMutex();

    // *************************************************************************
    // ***   Lock   ************************************************************
    // *************************************************************************
    Result Lock(TickType_t ticks_to_wait = portMAX_DELAY);

    // *************************************************************************
    // ***   Release   *********************************************************
    // *************************************************************************
    Result Release();

    // *************************************************************************
    // ***   IsTakenByCurrentTask   ********************************************
    // *************************************************************************
    bool IsTakenByCurrentTask(void);

  private:
    // Mutex handle
    SemaphoreHandle_t mutex;
};

#endif
